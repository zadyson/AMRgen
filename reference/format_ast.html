<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Import and Process AST Data from a generic format — format_ast • AMRgen</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito-0.4.10/font.css" rel="stylesheet"><link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import and Process AST Data from a generic format — format_ast"><meta name="description" content="This function attempts to import antibiotic susceptibility testing (AST) data in long-form antibiogram format (one row per sample and test), suitable for downstream use with AMRgen analysis functions. It assumes that the input file is a tab-delimited text file (e.g., TSV) or CSV (which may be compressed) and parses relevant columns (antibiotic names, species names, MIC or disk data, S/I/R calls) into suitable classes using the AMR package. It optionally can use the AMR package to interpret susceptibility phenotype (SIR) based on EUCAST or CLSI guidelines (human breakpoints and/or ECOFF). If expected columns are not found warnings will be given, and interpretation may not be possible."><meta property="og:description" content="This function attempts to import antibiotic susceptibility testing (AST) data in long-form antibiogram format (one row per sample and test), suitable for downstream use with AMRgen analysis functions. It assumes that the input file is a tab-delimited text file (e.g., TSV) or CSV (which may be compressed) and parses relevant columns (antibiotic names, species names, MIC or disk data, S/I/R calls) into suitable classes using the AMR package. It optionally can use the AMR package to interpret susceptibility phenotype (SIR) based on EUCAST or CLSI guidelines (human breakpoints and/or ECOFF). If expected columns are not found warnings will be given, and interpretation may not be possible."><meta property="og:image" content="https://AMRverse.github.io/AMRgen/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AMRgen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-book-open"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/AnalysingGenoPhenoData.html"><span class="fa fa-book"></span> Vignettes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/AMRverse/AMRgen"><span class="fa fab fa-github"></span> Source Code</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Import and Process AST Data from a generic format</h1>
      <small class="dont-index">Source: <a href="https://github.com/AMRverse/AMRgen/blob/main/R/import_pheno.R" class="external-link"><code>R/import_pheno.R</code></a></small>
      <div class="d-none name"><code>format_ast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function attempts to import antibiotic susceptibility testing (AST) data in long-form antibiogram format (one row per sample and test), suitable for downstream use with AMRgen analysis functions. It assumes that the input file is a tab-delimited text file (e.g., TSV) or CSV (which may be compressed) and parses relevant columns (antibiotic names, species names, MIC or disk data, S/I/R calls) into suitable classes using the AMR package. It optionally can use the AMR package to interpret susceptibility phenotype (SIR) based on EUCAST or CLSI guidelines (human breakpoints and/or ECOFF). If expected columns are not found warnings will be given, and interpretation may not be possible.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">format_ast</span><span class="op">(</span></span>
<span>  <span class="va">input</span>,</span>
<span>  sample_col <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  species_col <span class="op">=</span> <span class="st">"spp_pheno"</span>,</span>
<span>  ab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ab_col <span class="op">=</span> <span class="st">"drug_agent"</span>,</span>
<span>  mic_col <span class="op">=</span> <span class="st">"mic"</span>,</span>
<span>  disk_col <span class="op">=</span> <span class="st">"disk"</span>,</span>
<span>  pheno_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ecoff"</span>, <span class="st">"pheno_eucast"</span>, <span class="st">"pheno_clsi"</span>, <span class="st">"pheno_provided"</span><span class="op">)</span>,</span>
<span>  method_col <span class="op">=</span> <span class="st">"method"</span>,</span>
<span>  platform_col <span class="op">=</span> <span class="st">"platform"</span>,</span>
<span>  source_col <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>  guideline_col <span class="op">=</span> <span class="st">"guideline"</span>,</span>
<span>  interpret_eucast <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  interpret_clsi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  interpret_ecoff <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rename_cols <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-input">input<a class="anchor" aria-label="anchor" href="#arg-input"></a></dt>
<dd><p>A string representing a dataframe, or a path to an input file, containing the AST data in long-form antibiogram format (one row per sample and test). This might be a file containing the content of an EBI/NCBI AST dataset previously processed using <code><a href="import_ebi_ast.html">import_ebi_ast()</a></code>, <code><a href="import_ncbi_ast.html">import_ncbi_ast()</a></code>, or <code><a href="import_ast.html">import_ast()</a></code> functions, or files with a similar format/structure but with different column names.</p></dd>


<dt id="arg-sample-col">sample_col<a class="anchor" aria-label="anchor" href="#arg-sample-col"></a></dt>
<dd><p>(optional, default 'id') Name of the input data column that provides the sample name. If the 'rename' parameter is set to TRUE, this column will be renamed as 'id'.</p></dd>


<dt id="arg-species">species<a class="anchor" aria-label="anchor" href="#arg-species"></a></dt>
<dd><p>(optional) Name of the single species to which all samples belong. Use this if you want to interpret assay measurements but the input file does not contain a column indicating the species for each sample (called 'species' or a name specified by the <code>species_col</code> parameter).</p></dd>


<dt id="arg-species-col">species_col<a class="anchor" aria-label="anchor" href="#arg-species-col"></a></dt>
<dd><p>(optional, default 'species') Name of the input data column that provides a species name. If provided, this column will be converted to micro-organism class 'mo' via <code><a href="https://amr-for-r.org/reference/as.mo.html" class="external-link">AMR::as.mo()</a></code>. If the 'rename' parameter is set to TRUE, this column will also be renamed as 'spp_pheno'. If interpretation is switched on, this column will be used to identify the appropriate  breakpoints for interpretation of each row in the data table.</p></dd>


<dt id="arg-ab">ab<a class="anchor" aria-label="anchor" href="#arg-ab"></a></dt>
<dd><p>(optional) Name of a single antibiotic to use for phenotype interpretation. Use this if you want to interpret assay measurements but the input file does not contain a column indicating the drug for each sample (called 'drug_agent' or a name specified by the <code>ab_col</code> parameter).</p></dd>


<dt id="arg-ab-col">ab_col<a class="anchor" aria-label="anchor" href="#arg-ab-col"></a></dt>
<dd><p>(optional, default 'drug_agent') Name of the input data column that provides a drug name. If provided, this column will be converted to antibiotic class 'ab' via <code><a href="https://amr-for-r.org/reference/as.ab.html" class="external-link">AMR::as.ab()</a></code>. If the 'rename' parameter is set to TRUE, this column will also be renamed as 'drug_agent'. If interpretation is switched on, this column will be used to identify the appropriate breakpoints for interpretation of each row in the data table.</p></dd>


<dt id="arg-mic-col">mic_col<a class="anchor" aria-label="anchor" href="#arg-mic-col"></a></dt>
<dd><p>(optional, default 'mic') Name of the input data column that provides MIC measurements. If provided, this column will be converted to MIC class 'mic' via <code><a href="https://amr-for-r.org/reference/as.mic.html" class="external-link">AMR::as.mic()</a></code>. If the 'rename' parameter is set to TRUE, this column will also be renamed as 'mic'. If interpretation is switched on, the MIC values will be interpreted against clinical breakpoints.</p></dd>


<dt id="arg-disk-col">disk_col<a class="anchor" aria-label="anchor" href="#arg-disk-col"></a></dt>
<dd><p>(optional, default 'disk') Name of the input data column that provides disk diffusion zone measurements. If provided, this column will be converted to disk diffusion class 'disk' via <code><a href="https://amr-for-r.org/reference/as.disk.html" class="external-link">AMR::as.disk()</a></code>. If the 'rename' parameter is set to TRUE, this column will also be renamed as 'disk'. If interpretation is switched on, the zone values will be interpreted against clinical breakpoints.</p></dd>


<dt id="arg-pheno-cols">pheno_cols<a class="anchor" aria-label="anchor" href="#arg-pheno-cols"></a></dt>
<dd><p>(optional, default <code>c("ecoff", "pheno_eucast", "pheno_clsi", "pheno_provided")</code>) Name of the input data column/s that provides disk diffusion zone measurements (as a character vector, or single string for a single column). If provided, these columns will be converted to SIR class 'sir' via <code><a href="https://amr-for-r.org/reference/as.sir.html" class="external-link">AMR::as.sir()</a></code>.</p></dd>


<dt id="arg-method-col">method_col<a class="anchor" aria-label="anchor" href="#arg-method-col"></a></dt>
<dd><p>(optional, default 'method') Name of the input data column that indicates the testing method used (e.g. MIC, disk diffusion). If the 'rename' parameter is set to TRUE, this column will also be renamed as 'method'.</p></dd>


<dt id="arg-platform-col">platform_col<a class="anchor" aria-label="anchor" href="#arg-platform-col"></a></dt>
<dd><p>(optional, default 'platform') Name of the input data column that indicates the testing platform used (e.g. Vitek, Sensititre). If the 'rename' parameter is set to TRUE, this column will also be renamed as 'platform'.</p></dd>


<dt id="arg-source-col">source_col<a class="anchor" aria-label="anchor" href="#arg-source-col"></a></dt>
<dd><p>(optional, default 'source') Name of the input data column that indicates the source of the dataset (e.g. BioProject, PMID). If the 'rename' parameter is set to TRUE, this column will also be renamed as 'source'.</p></dd>


<dt id="arg-guideline-col">guideline_col<a class="anchor" aria-label="anchor" href="#arg-guideline-col"></a></dt>
<dd><p>(optional, default 'guideline') Name of the input data column that indicates the guideline used for testing (e.g. EUCAST, CLSI). If the 'rename' parameter is set to TRUE, this column will also be renamed as 'guideline'.</p></dd>


<dt id="arg-interpret-eucast">interpret_eucast<a class="anchor" aria-label="anchor" href="#arg-interpret-eucast"></a></dt>
<dd><p>A logical value (default is FALSE). If <code>TRUE</code>, the function will interpret the susceptibility phenotype (SIR) for each row based on the MIC or disk diffusion values, against EUCAST human breakpoints. These will be reported in a new column <code>pheno_eucast</code>, of class 'sir'.</p></dd>


<dt id="arg-interpret-clsi">interpret_clsi<a class="anchor" aria-label="anchor" href="#arg-interpret-clsi"></a></dt>
<dd><p>A logical value (default is FALSE). If <code>TRUE</code>, the function will interpret the susceptibility phenotype (SIR) for each row based on the MIC or disk diffusion values, against CLSI human breakpoints. These will be reported in a new column <code>pheno_clsi</code>, of class 'sir'.</p></dd>


<dt id="arg-interpret-ecoff">interpret_ecoff<a class="anchor" aria-label="anchor" href="#arg-interpret-ecoff"></a></dt>
<dd><p>A logical value (default is FALSE). If <code>TRUE</code>, the function will interpret the wildtype vs nonwildtype status for each row based on the MIC or disk diffusion values, against epidemiological cut-off (ECOFF) values. These will be reported in a new column <code>ecoff</code>, of class 'sir' and coded as 'R' (nonwildtype) or 'S' (wildtype).</p></dd>


<dt id="arg-rename-cols">rename_cols<a class="anchor" aria-label="anchor" href="#arg-rename-cols"></a></dt>
<dd><p>A logical value (default is TRUE). If <code>TRUE</code>, the function will rename the provided columns (specified by <code>ab_col</code>, <code>mic_col</code>, <code>disk_col</code>, <code>species_col</code>, <code>id_col</code>) to the default names expected by AMRgen functions ('drug_agent', 'mic', 'disk', 'spp_pheno', 'id'), to match those output by the other <code><a href="import_ast.html">import_ast()</a></code> functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with the processed AST data, including additional columns:</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># import and process AST data from EBI, write formatted data to file for later use</span></span></span>
<span class="r-in"><span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu"><a href="import_ebi_ast.html">import_ebi_ast</a></span><span class="op">(</span><span class="st">"EBI_AMR_data.csv.gz"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">write_tsv</span><span class="op">(</span><span class="va">pheno</span>,</span></span>
<span class="r-in"><span>  file <span class="op">=</span> <span class="st">"EBI_AMR_data_processed.tsv.gz"</span>,</span></span>
<span class="r-in"><span>  interpret_eucast <span class="op">=</span> <span class="cn">TRUE</span>, interpret_ecoff <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># read stored data and format the columns to the correct classes</span></span></span>
<span class="r-in"><span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu">format_ast</span><span class="op">(</span><span class="st">"EBI_AMR_data_processed.tsv.gz"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># read in unprocessed E. coli AST data from non-standard format and interpret</span></span></span>
<span class="r-in"><span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu">format_ast</span><span class="op">(</span><span class="st">"AMR_data.tsv"</span>,</span></span>
<span class="r-in"><span>  sample_col <span class="op">=</span> <span class="st">"STRAIN"</span>, species <span class="op">=</span> <span class="st">"E. coli"</span>,</span></span>
<span class="r-in"><span>  ab_col <span class="op">=</span> <span class="st">"Antibiotic"</span>, mic_col <span class="op">=</span> <span class="st">"MIC (mg/L)"</span>,</span></span>
<span class="r-in"><span>  interpret_eucast <span class="op">=</span> <span class="cn">TRUE</span>, interpret_ecoff <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Free and Open Source (GPL-3), brought by AMRverse/AMRgen Development Team</p>
</div>

<div class="pkgdown-footer-right">
  <p>Our goal is to develop interpretive standards for AMR genotypes, akin to the interpretive standards developed by EUCAST and CLSI for antimicrobial susceptibility phenotyping.</p>
</div>

    </footer></div>





  </body></html>

