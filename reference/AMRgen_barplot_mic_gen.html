<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate a Stacked Bar Plot of MIC Values Colored by Gene Symbol for Each Antibiotic — AMRgen_barplot_mic_gen • AMRgen</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate a Stacked Bar Plot of MIC Values Colored by Gene Symbol for Each Antibiotic — AMRgen_barplot_mic_gen"><meta name="description" content="This function creates a stacked bar plot using ggplot2, where the x-axis represents MIC (Minimum Inhibitory Concentration) values,
the y-axis represents their frequency, and the bars are colored by the gene symbols. The plot is faceted by antibiotic."><meta property="og:description" content="This function creates a stacked bar plot using ggplot2, where the x-axis represents MIC (Minimum Inhibitory Concentration) values,
the y-axis represents their frequency, and the bars are colored by the gene symbols. The plot is faceted by antibiotic."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AMRgen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-book-open"></span> Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/interpretAMR/AMRgen"><span class="fa fab fa-github"></span> Source Code</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generate a Stacked Bar Plot of MIC Values Colored by Gene Symbol for Each Antibiotic</h1>
      <small class="dont-index">Source: <a href="https://github.com/interpretAMR/AMRgen/blob/main/R/AMRgen_barplot_mic_gen_v1.0.R" class="external-link"><code>R/AMRgen_barplot_mic_gen_v1.0.R</code></a></small>
      <div class="d-none name"><code>AMRgen_barplot_mic_gen.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates a stacked bar plot using <code>ggplot2</code>, where the x-axis represents MIC (Minimum Inhibitory Concentration) values,
the y-axis represents their frequency, and the bars are colored by the gene symbols. The plot is faceted by antibiotic.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AMRgen_barplot_mic_gen</span><span class="op">(</span></span>
<span>  <span class="va">pheno_data</span>,</span>
<span>  <span class="va">geno_data</span>,</span>
<span>  <span class="va">pathogen_mo</span>,</span>
<span>  <span class="va">abs_to_plot</span>,</span>
<span>  pheno_sample_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geno_sample_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  measure_method <span class="op">=</span> <span class="st">"mic"</span>,</span>
<span>  breakpoint_source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"EUCAST"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  breakpoint_type <span class="op">=</span> <span class="st">"ECOFF"</span>,</span>
<span>  color_by <span class="op">=</span> <span class="st">"gene"</span>,</span>
<span>  plot_title <span class="op">=</span> <span class="st">"Frequency distribution of values for different genotypes"</span>,</span>
<span>  leg_pos <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>  ncol_leg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">geno_data</span><span class="op">$</span><span class="va">marker</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pheno-data">pheno_data<a class="anchor" aria-label="anchor" href="#arg-pheno-data"></a></dt>
<dd><p>A data.frame read in by the phenotypic parser, containing a column listing the sample ID, "spp_pheno" (class mo),
"drug_agent" (class ab), "mic" (class mic), "disk" (class disk).
The sample ID column is used to match to geno_data.</p></dd>


<dt id="arg-geno-data">geno_data<a class="anchor" aria-label="anchor" href="#arg-geno-data"></a></dt>
<dd><p>A data.frame generated by the genotypic parser, containing a sample ID column, "marker" (class gene),
"drug_agent" (class ab, note this value can be NA if there is no specific agent),
and "drug_class" (controlled vocab of drug classes for the AMR package)</p></dd>


<dt id="arg-pathogen-mo">pathogen_mo<a class="anchor" aria-label="anchor" href="#arg-pathogen-mo"></a></dt>
<dd><p>A string in mo format specifying what pathogen
is used to select breakpoints, e.g. 'B_STPHY_AURS'</p></dd>


<dt id="arg-abs-to-plot">abs_to_plot<a class="anchor" aria-label="anchor" href="#arg-abs-to-plot"></a></dt>
<dd><p>A vector of strings listing the antibiotic drugs you wish to plot. Need to be
in three letter code format as per the AMR package</p></dd>


<dt id="arg-pheno-sample-col">pheno_sample_col<a class="anchor" aria-label="anchor" href="#arg-pheno-sample-col"></a></dt>
<dd><p>The name of the sample column in pheno_data, defaults to first column</p></dd>


<dt id="arg-geno-sample-col">geno_sample_col<a class="anchor" aria-label="anchor" href="#arg-geno-sample-col"></a></dt>
<dd><p>The name of the sample column in geno_data, defaults to first column</p></dd>


<dt id="arg-measure-method">measure_method<a class="anchor" aria-label="anchor" href="#arg-measure-method"></a></dt>
<dd><p>A string specifying the method used to measure antimicrobial resistance.
The default is 'mic' for Minimum Inhibitory Concentration, the other option is 'disk' for Disk Diffusion.</p></dd>


<dt id="arg-breakpoint-source">breakpoint_source<a class="anchor" aria-label="anchor" href="#arg-breakpoint-source"></a></dt>
<dd><p>A string representing the source for breakpoint data. By default, it is set
to EUCAST 2023.</p></dd>


<dt id="arg-breakpoint-type">breakpoint_type<a class="anchor" aria-label="anchor" href="#arg-breakpoint-type"></a></dt>
<dd><p>A string specifying the type of breakpoint to use, default is 'ECOFF'.</p></dd>


<dt id="arg-color-by">color_by<a class="anchor" aria-label="anchor" href="#arg-color-by"></a></dt>
<dd><p>A string specifying the variable used to color the plot elements. Options include
'gene' (default) to color by gene, or 'class' to color by drug class. Any other strings also default to gene.</p></dd>


<dt id="arg-plot-title">plot_title<a class="anchor" aria-label="anchor" href="#arg-plot-title"></a></dt>
<dd><p>A string specifying the title of the plot. The default title is
"Frequency distribution of values for different genotypes".</p></dd>


<dt id="arg-leg-pos">leg_pos<a class="anchor" aria-label="anchor" href="#arg-leg-pos"></a></dt>
<dd><p>A string specifying the position of the plot's legend. The default is 'bottom',
but other options include 'top', 'left', or 'right'.</p></dd>


<dt id="arg-ncol-leg">ncol_leg<a class="anchor" aria-label="anchor" href="#arg-ncol-leg"></a></dt>
<dd><p>An integer specifying the number of columns for the legend. By default, it is
calculated based on the number of unique gene symbols in <code>geno_data</code>, rounded to 10 items per column, but minimally 2.
This ensures the legend is well-organized when there are many gene symbols.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot2 object representing the stacked bar plot.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ul><li><p>The function automatically groups the data by <code>Antibiotic</code>, <code>MIC (mg/L)</code>, and <code>Gene symbol</code> and calculates the frequency of occurrences.</p></li>
<li><p>The plot uses the <code>viridis</code> color scale with the "turbo" palette by default. You can replace it with your custom palette if desired.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">AMRgen_barplot_mic_gen</span><span class="op">(</span><span class="va">pheno_data</span>,</span></span>
<span class="r-in"><span>  <span class="va">geno_data</span>,</span></span>
<span class="r-in"><span>  abs_to_plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CIP"</span>, <span class="st">"IPM"</span>, <span class="st">"MEM"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  measure_method <span class="op">=</span> <span class="st">"mic"</span>,</span></span>
<span class="r-in"><span>  pathogen_mo <span class="op">=</span> <span class="st">"B_ESCHR_COLI"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Free and Open Source (GPL-2), brought by interpretAMR-AMRgen Development Team</p>
</div>

<div class="pkgdown-footer-right">
  <p>Our goal is to develop interpretive standards for AMR genotypes, akin to the interpretive standards developed by EUCAST and CLSI for antimicrobial susceptibility phenotyping.</p>
</div>

    </footer></div>





  </body></html>

