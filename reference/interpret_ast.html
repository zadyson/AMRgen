<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Interpret AST data in a standard format tibble — interpret_ast • AMRgen</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito-0.4.10/font.css" rel="stylesheet"><link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interpret AST data in a standard format tibble — interpret_ast"><meta name="description" content="This function applies human EUCAST or CLSI breakpoints, and/or ECOFF, to interpret AST data."><meta property="og:description" content="This function applies human EUCAST or CLSI breakpoints, and/or ECOFF, to interpret AST data."><meta property="og:image" content="https://AMRverse.github.io/AMRgen/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AMRgen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-book-open"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/AnalysingGenoPhenoData.html"><span class="fa fa-book"></span> Vignettes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/AMRverse/AMRgen"><span class="fa fab fa-github"></span> Source Code</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Interpret AST data in a standard format tibble</h1>
      <small class="dont-index">Source: <a href="https://github.com/AMRverse/AMRgen/blob/main/R/import_pheno.R" class="external-link"><code>R/import_pheno.R</code></a></small>
      <div class="d-none name"><code>interpret_ast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function applies human EUCAST or CLSI breakpoints, and/or ECOFF, to interpret AST data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">interpret_ast</span><span class="op">(</span></span>
<span>  <span class="va">ast</span>,</span>
<span>  interpret_ecoff <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interpret_eucast <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interpret_clsi <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ab <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ast">ast<a class="anchor" aria-label="anchor" href="#arg-ast"></a></dt>
<dd><p>A tibble containing the AST measures in standard AMRgen format, as output by <code>import_ast</code>. It must contain assay measurements in columns 'mic' (class mic) and/or 'disk'. Interpretation requires an organism (column 'spp_pheno' of class 'mo', or a single value passed via the 'species' parameter) and an antibiotic (column 'drug_agent' of class 'ab', or a single value passed via the 'ab' parameter).</p></dd>


<dt id="arg-interpret-ecoff">interpret_ecoff<a class="anchor" aria-label="anchor" href="#arg-interpret-ecoff"></a></dt>
<dd><p>A logical value (default is FALSE). If <code>TRUE</code>, the function will interpret the wildtype vs nonwildtype status for each row based on the MIC or disk diffusion values, against epidemiological cut-off (ECOFF) values. These will be reported in a new column <code>ecoff</code>, of class 'sir' and coded as 'R' (nonwildtype) or 'S' (wildtype).</p></dd>


<dt id="arg-interpret-eucast">interpret_eucast<a class="anchor" aria-label="anchor" href="#arg-interpret-eucast"></a></dt>
<dd><p>A logical value (default is FALSE). If <code>TRUE</code>, the function will interpret the susceptibility phenotype (SIR) for each row based on the MIC or disk diffusion values, against EUCAST human breakpoints. These will be reported in a new column <code>pheno_eucast</code>, of class 'sir'.</p></dd>


<dt id="arg-interpret-clsi">interpret_clsi<a class="anchor" aria-label="anchor" href="#arg-interpret-clsi"></a></dt>
<dd><p>A logical value (default is FALSE). If <code>TRUE</code>, the function will interpret the susceptibility phenotype (SIR) for each row based on the MIC or disk diffusion values, against CLSI human breakpoints. These will be reported in a new column <code>pheno_clsi</code>, of class 'sir'.</p></dd>


<dt id="arg-species">species<a class="anchor" aria-label="anchor" href="#arg-species"></a></dt>
<dd><p>(optional) Name of the species to use for phenotype interpretation. By default, the spp_pheno field in the input file will be assumed to specify the species for each sample, but if this is missing or you want to override it in the interpretation step, you may provide a single species name via this parameter.</p></dd>


<dt id="arg-ab">ab<a class="anchor" aria-label="anchor" href="#arg-ab"></a></dt>
<dd><p>(optional) Name of the antibiotic to use for phenotype interpretation. By default, the drug_agent field in the input file will be assumed to specify the antibiotic for each sample, but if this is missing or you want to override it in the interpretation step, you may provide a single antibiotic name via this parameter.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A copy of the input table, with additional columns:</p><ul><li><p><code>pheno_eucast</code>: The phenotype newly interpreted against EUCAST human breakpoint standards (as S/I/R), based on the MIC or disk diffusion data.</p></li>
<li><p><code>pheno_clsi</code>: The phenotype newly interpreted against CLSI human breakpoint standards (as S/I/R), based on the MIC or disk diffusion data.</p></li>
<li><p><code>ecoff</code>: The phenotype newly interpreted against the ECOFF (as S/R), based on the MIC or disk diffusion data.</p></li>
<li><p><code>spp_pheno</code>: The species phenotype, formatted using the <code>as.mo</code> function (either taken from the input table, or the single value specified by 'species' parameter).</p></li>
<li><p><code>drug_agent</code>: The antibiotic used in the test, formatted using the <code>as.ab</code> function (either taken from the input table, or the single value specified by 'ab' parameter)..</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># import without re-interpreting resistance</span></span></span>
<span class="r-in"><span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu"><a href="import_ncbi_ast.html">import_ncbi_ast</a></span><span class="op">(</span><span class="va">ecoli_ast_raw</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Warning: Expected AST method column 'Laboratory typing method' not found in input</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Warning: Expected column 'BioProject' not found in input</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 29</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id           drug_agent     mic  disk guideline method platform pheno_provided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;ab&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;mic&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dsk&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;sir&gt;</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> SAMN36015110 CIP        <span style="color: #555555;">&lt;</span>128<span style="color: #555555;">.00</span>    <span style="color: #BB0000;">NA</span> CLSI      MIC    <span style="color: #BB0000;">NA</span>       <span style="color: #080808; background-color: #FF5F5F;">  R  </span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> SAMN11638310 CIP         256<span style="color: #555555;">.00</span>    <span style="color: #BB0000;">NA</span> CLSI      MIC    <span style="color: #BB0000;">NA</span>       <span style="color: #080808; background-color: #FF5F5F;">  R  </span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> SAMN05729964 CIP          64<span style="color: #555555;">.00</span>    <span style="color: #BB0000;">NA</span> CLSI      Etest  Etest    <span style="color: #080808; background-color: #FF5F5F;">  R  </span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> SAMN10620111 CIP         <span style="color: #555555;">&gt;=</span>4<span style="color: #555555;">.00</span>    <span style="color: #BB0000;">NA</span> CLSI      MIC    <span style="color: #BB0000;">NA</span>       <span style="color: #080808; background-color: #FF5F5F;">  R  </span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> SAMN10620168 CIP         <span style="color: #555555;">&gt;=</span>4<span style="color: #555555;">.00</span>    <span style="color: #BB0000;">NA</span> CLSI      MIC    <span style="color: #BB0000;">NA</span>       <span style="color: #080808; background-color: #FF5F5F;">  R  </span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> SAMN10620104 CIP         <span style="color: #555555;">&lt;=</span>0.25    <span style="color: #BB0000;">NA</span> CLSI      MIC    <span style="color: #BB0000;">NA</span>       <span style="color: #080808; background-color: #5FD7AF;">  S  </span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 21 more variables: spp_pheno &lt;mo&gt;, `Organism group` &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   `Scientific name` &lt;chr&gt;, `Isolation type` &lt;chr&gt;, Location &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   `Isolation source` &lt;chr&gt;, Isolate &lt;chr&gt;, Antibiotic &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   `Resistance phenotype` &lt;chr&gt;, `Measurement sign` &lt;chr&gt;, `MIC (mg/L)` &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   `Disk diffusion (mm)` &lt;lgl&gt;, `Laboratory typing platform` &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Vendor &lt;chr&gt;, `Laboratory typing method version or reagent` &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   `Testing standard` &lt;chr&gt;, `Create date` &lt;dttm&gt;, pheno_clsi_mic &lt;sir&gt;, …</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># interpret phenotypes</span></span></span>
<span class="r-in"><span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu">interpret_ast</span><span class="op">(</span><span class="va">pheno</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There was 1 warning in `mutate()`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In argument: `across(...)`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Caused by warning:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Some MICs were converted to the nearest higher log2 level, following the</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> CLSI interpretation guideline.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"AST.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co"># convert antibiotic field to 'drug_agent' of class 'ab'</span></span></span>
<span class="r-in"><span>  <span class="fu">mutate</span><span class="op">(</span>drug_agent <span class="op">=</span> <span class="fu">as.ab</span><span class="op">(</span><span class="va">antibiotic</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">mutate</span><span class="op">(</span>mic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">sign</span>, <span class="va">MIC</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">mutate</span><span class="op">(</span>mic <span class="op">=</span> <span class="fu">as.mic</span><span class="op">(</span><span class="va">mic</span><span class="op">)</span><span class="op">)</span> <span class="co"># create a single 'mic' column of class 'mic'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu">interpret_ast</span><span class="op">(</span><span class="va">pheno</span>, species <span class="op">=</span> <span class="st">"Escherichia coli"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Free and Open Source (GPL-3), brought by AMRverse/AMRgen Development Team</p>
</div>

<div class="pkgdown-footer-right">
  <p>Our goal is to develop interpretive standards for AMR genotypes, akin to the interpretive standards developed by EUCAST and CLSI for antimicrobial susceptibility phenotyping.</p>
</div>

    </footer></div>





  </body></html>

